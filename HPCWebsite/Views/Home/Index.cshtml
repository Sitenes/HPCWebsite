@using HPCWebsite.Controllers
@model ServerPlansViewModel
@{
    ViewData["Title"] = "خانه";
}
<!-- Hero Section Begin -->
<section class="hero-section">
    <div class="hero__slider owl-carousel">
        <div class="hero__item set-bg" data-setbg="/static/img/hero/hero-1.jpg">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="hero__text">
                            <h5>قدرت پردازشی نامحدود در دستان شما</h5>
                            <h2>
                                سرورهای پرسرعت ابری
                                با قیمت شگفت‌انگیز
                            </h2>
                            <a href="#" class="primary-btn">همین حالا شروع کنید</a>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="hero__img">
                            <img src="/static/img/hero/hero-right.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero__item set-bg" data-setbg="/static/img/hero/hero-1.jpg">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="hero__text">
                            <h2>سروری سریع، پایدار و همیشه در دسترس</h2>
                            <a href="#" class="primary-btn">همین حالا شروع کنید</a>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="hero__img">
                            <img src="/static/img/hero/hero-right.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero__item set-bg" data-setbg="/static/img/hero/hero-1.jpg">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="hero__text">
                            <h5>بهترین انتخاب برای استارتاپ‌ها و کسب‌وکارها</h5>
                            <h2>
                                سرور ابری مقرون‌به‌صرفه
                                با راه‌اندازی آنی
                            </h2>
                            <a href="#" class="primary-btn">همین حالا شروع کنید</a>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="hero__img">
                            <img src="/static/img/hero/hero-right.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Hero Section End -->
<!-- Pricing Section Begin -->
<section class="pricing-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-5 col-md-5 server-select-box">
                <div class="pricing__swipe-btn">
                    <label for="month" class="active">
                        CPU
                        <input type="radio" id="month" checked>
                    </label>
                    <label for="yearly">
                        GPU
                        <input type="radio" id="yearly">
                    </label>
                </div>
            </div>
            <div class="col-lg-7 col-md-7">
                <div class="section-title normal-title">
                    <p>سرورهای پردازش سریع، فقط چند کلیک با شما فاصله دارند</p>
                    <h3>طرح مناسب خود را انتخاب کنید</h3>
                </div>
            </div>
        </div>

        <div class="row monthly__plans active">
            @{
                int index = 0;
            }
            @foreach (var server in Model.CPUServers)
            {
                var isPopular = index == 2 ? " popular" : "";
                <div class="col-lg-3 col-sm-6">
                    <div class="pricing__item @isPopular">
                        @if (index == 2)
                        {
                            <div class="popular-badge">
                                <span class="badge-text">پرفروش‌ترین</span>
                                <span class="badge-icon flame-icon">🔥</span>
                            </div>
                        }
                        <h4>@server.Name</h4>
                        <h5>@server.DailyPrice.ToString("N0") تومان (روزانه)</h5>
                        <ul>
                            @if (server.Cores > 0)
                            {
                                <li>پردازنده: @(server.Cores) هسته</li>
                            }
                            @if (server.RamGB > 0)
                            {
                                <li>حافظه رم: @(server.RamGB) گیگابایت</li>
                            }
                            @if (server.StorageGB > 0)
                            {
                                <li>ذخیره‌سازی: @(server.StorageGB) گیگابایت</li>
                            }
                            @if (!string.IsNullOrEmpty(server.Uptime) && server.Uptime != "-")
                            {
                                <li>آپتایم: @server.Uptime</li>
                            }
                            @if (!string.IsNullOrEmpty(server.DeliveryTime) && server.DeliveryTime != "-")
                            {
                                <li>زمان تحویل: @server.DeliveryTime</li>
                            }
                            @if (!string.IsNullOrEmpty(server.ProcessingSpeed) && server.ProcessingSpeed != "-")
                            {
                                <li>سرعت پردازش: @server.ProcessingSpeed</li>
                            }
                            @if (!string.IsNullOrEmpty(server.SuitableFor) && server.SuitableFor != "-")
                            {
                                <li>مناسب برای: @server.SuitableFor</li>
                            }
                        </ul>
                        <a href="#" class="primary-btn add-to-cart" data-server-id="@server.Id">رزرو</a>
                    </div>
                </div>
                index++;
            }
        </div>

        <div class="row yearly__plans">
            @{
                int indexGPU = 0;
            }
            @foreach (var server in Model.GPUServers)
            {
                var isPopular = indexGPU == 2 ? " popular" : "";
                <div class="col-lg-3 col-sm-6">
                    <div class="pricing__item @isPopular">
                        @if (indexGPU == 2)
                        {
                            <div class="popular-badge">
                                <span class="badge-text">پرفروش‌ترین</span>
                                <span class="badge-icon flame-icon">🔥</span>
                            </div>
                        }
                        <h4>@server.Name</h4>
                        <h5>@server.DailyPrice.ToString("N0") تومان (روزانه)</h5>
                        <ul>
                            @if (!string.IsNullOrEmpty(server.GpuType) && server.GpuType != "-")
                            {
                                <li>پردازنده گرافیکی: @(server.GpuType)</li>
                            }
                            @if (server.GpuCount > 0)
                            {
                                <li>تعداد پردازنده گرافیکی: @(server.GpuCount)</li>
                            }
                            @if (server.Cores > 0)
                            {
                                <li>پردازنده: @(server.Cores) هسته</li>
                            }
                            @if (server.RamGB > 0)
                            {
                                <li>حافظه رم: @(server.RamGB) گیگابایت</li>
                            }
                            @if (server.StorageGB > 0)
                            {
                                <li>ذخیره‌سازی: @(server.StorageGB) گیگابایت</li>
                            }
                            @if (!string.IsNullOrEmpty(server.Uptime) && server.Uptime != "-")
                            {
                                <li>آپتایم: @server.Uptime</li>
                            }
                            @if (!string.IsNullOrEmpty(server.DeliveryTime) && server.DeliveryTime != "-")
                            {
                                <li>زمان تحویل: @server.DeliveryTime</li>
                            }
                            @if (!string.IsNullOrEmpty(server.ProcessingSpeed) && server.ProcessingSpeed != "-")
                            {
                                <li>سرعت پردازش: @server.ProcessingSpeed</li>
                            }
                            @if (!string.IsNullOrEmpty(server.SuitableFor) && server.SuitableFor != "-")
                            {
                                <li>مناسب برای: @server.SuitableFor</li>
                            }
                        </ul>
                        <a href="#" class="primary-btn add-to-cart" data-server-id="@server.Id">رزرو</a>
                    </div>
                </div>
                indexGPU++;
            }
        </div>
    </div>
</section>

<!-- Services Section Begin -->
<section class="services-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title">
                    <h3>چرا مشتریان ما رو انتخاب می‌کنند</h3>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="services__item">
                    <h5>پردازش آنی و قدرتمند</h5>
                    <span>اجرای پروژه‌های سنگین</span>
                    <p>اجرای پروژه‌های سنگین در کمترین زمان با قدرت سخت‌افزاری بالا</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="services__item">
                    <h5>محاسبه هزینه به‌صورت ساعتی</h5>
                    <span>پرداخت منعطف</span>
                    <p>فقط به اندازه‌ی مصرف واقعی پرداخت کنید</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="services__item">
                    <h5>دسترسی ۲۴/۷ به سرورها</h5>
                    <span>اتصال ایمن</span>
                    <p>همیشه و همه‌جا قابل استفاده با اتصال ایمن</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="services__item">
                    <h5>پشتیبانی از GPU قدرتمند</h5>
                    <span>برای پردازش گرافیکی</span>
                    <p>پشتیبانی از GPU قدرتمند برای رندر و محاسبات گرافیکی سنگین</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="services__item">
                    <h5>راه‌اندازی در کمتر از یک دقیقه</h5>
                    <span>بدون انتظار</span>
                    <p>سرور خود را با چند کلیک و بدون انتظار، بلافاصله فعال کنید</p>
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6">
                <div class="services__item">
                    <h5>پشتیبانی فوری و تخصصی</h5>
                    <span>تیم فنی همیشه در دسترس</span>
                    <p>تیم فنی همیشه در دسترس برای رفع مشکلات و پاسخ به سوالات شما</p>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Services Section End -->
<!-- بخش دستاوردها -->
<section class="achievement-section set-bg spad" data-setbg="/static/img/achievement-bg.jpg">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-3 col-sm-6">
                <div class="achievement__item">
                    <span class="fa fa-user-o"></span>
                    <h2 class="achieve-counter">100</h2>
                    <p>کاربران فعال در سراسر کشور</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6">
                <div class="achievement__item">
                    <span class="fa fa-edit"></span>
                    <h2 class="achieve-counter">10</h2>
                    <p>سفارش فعال ساعتی</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6">
                <div class="achievement__item">
                    <span class="fa fa-check"></span>
                    <h2 class="achieve-counter">50</h2>
                    <p>سرورهای راه‌اندازی‌شده کمتر از ۵ دقیقه</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6">
                <div class="achievement__item">
                    <span class="fa fa-cog"></span>
                    <h2 class="achieve-counter">100</h2>
                    <p>پروژه‌های پردازش‌شده با GPU</p>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- پایان بخش دستاوردها -->
<!-- بخش نحوه کار -->
<section class="work-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title">
                    <h3>تنها چند قدم تا سرور قدرتمند شما</h3>
                </div>
                <div class="work__text">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="work__item">
                                <i class="fa fa-bolt"></i>
                                <span>بدون معطلی، جدول</span>
                                <h3>سرور خود را در لحظه بسازید</h3>
                                <p>
                                    با چند کلیک ساده، سرور دلخواه‌تان را انتخاب و در کمتر از ۶۰ ثانیه راه‌اندازی کنید
                                </p>
                                <a href="#" class="primary-btn">جزئیات بیشتر</a>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="work__item">
                                <i class="fa fa-rocket"></i>
                                <span>سرورهای تخصصی برای هوش مصنوعی و تحلیل داده</span>
                                <h3>زیرساخت محاسباتی ویژه</h3>
                                <p>
                                    سرورهایی با پردازش سریع، محاسبه هزینه به‌صورت ساعتی و پشتیبانی تخصصی، مناسب برای مدل‌های هوش مصنوعی و انواع پردازش‌های سنگین
                                </p>
                                <a href="#" class="primary-btn">اطلاعات بیشتر</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- پایان بخش نحوه کار -->
<!-- انتخاب پلن بخش -->
<section class="choose-plan-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6">
                <img src="/static/img/choose-plan.png" alt="">
            </div>
            <div class="col-lg-6 col-md-6">
                <div class="plan__text">
                    <h3>تا ۵۰% تخفیف برای دانشجویان و اساتید دانشگاه اصفهان!</h3>
                    <ul>
                        <li>تخفیف‌های ویژه برای تیم‌های تحقیقاتی و استارتاپ‌ها <span class="fa fa-check"></span></li>
                        <li>پردازش سریع و بدون تأخیر <span class="fa fa-check"></span></li>
                        <li>محاسبه هزینه به‌صورت ساعتی و بهینه <span class="fa fa-check"></span></li>
                        <li>پشتیبانی ۲۴ ساعته و تخصصی <span class="fa fa-check"></span></li>
                        <li>راه‌اندازی سریع و بدون نیاز به تنظیمات پیچیده <span class="fa fa-check"></span></li>
                        <li>مناسب برای مدل‌های هوش مصنوعی و داده‌کاوی <span class="fa fa-check"></span></li>
                    </ul>
                    <a href="#" class="primary-btn">همین حالا شروع کنید</a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Modal برای انتخاب تعداد روزهای اجاره -->
<div class="modal fade" id="rentalDaysModal" tabindex="-1" role="dialog" aria-labelledby="rentalDaysModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="rentalDaysModalLabel">انتخاب مدت اجاره</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="rentalDays">تعداد روزهای اجاره:</label>
                    <input type="number" class="form-control" id="rentalDays" min="1" value="1">
                </div>
                <div id="pricePreview" class="mt-3"></div>
            </div>
            <div class="modal-footer">

                <button type="button" class="primary-btn add-to-cart" id="confirmRental">تایید و افزودن به سبد خرید</button>
            </div>
        </div>
    </div>
</div>

<!-- پایان بخش انتخاب پلن -->
@section Scripts {
    <script>
        $(document).ready(function() {
            // رویداد کلیک برای دکمه‌های رزرو
            $('.add-to-cart').click(function(e) {
                e.preventDefault();
                const serverId = $(this).data('server-id');

                // نمایش مدال برای انتخاب تعداد روزهای اجاره
                $('#rentalDaysModal').modal('show');

                // ذخیره serverId در دکمه تایید مدال
                $('#confirmRental').data('server-id', serverId);
            });

            $('#confirmRental').click(function() {
                const serverId = $(this).data('server-id');
                const rentalDays = $('#rentalDays').val();

                // if (!rentalDays || rentalDays < 1) {
                //     toastr.error('لطفاً تعداد روزهای اجاره را وارد کنید');
                //     return;
                // }

                // ارسال درخواست به سرور
                addToCart(serverId, rentalDays);
            });

                   function addToCart(serverId, rentalDays) {
            $.ajax({
                url: '/Cart/AddToCart',
                type: 'POST',
                data: {
                    serverId: serverId,
                    rentalDays: rentalDays
                },
                success: function(response) {
                    if (response.success) {
                        // toastr.success('سرور با موفقیت به سبد خرید اضافه شد');
                        $('#cartItemsCount').text(response.cartItemCount);
                        $('#rentalDaysModal').modal('hide');

                        // بررسی وجود redirectUrl پس از موفقیت
                        if (response.redirectUrl) {
                            setTimeout(() => {
                                window.location.href = response.redirectUrl;
                            }, 1000); // صبر ۱ ثانیه برای نمایش نوتیفیکیشن
                        }
                    } else {
                        // toastr.error(response.message);
                    }
                },
                error: function() {
                    // toastr.error('خطا در ارتباط با سرور');
                }
            });
        }

        });
    </script>
}